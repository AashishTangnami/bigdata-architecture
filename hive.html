<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Apache Hive: Behind the Scenes of Big Data Warehousing</title>
        <style>
            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #f8fafc 0%, #e8eaf6 100%);
                color: #222;
                margin: 0;
                padding: 0;
            }
            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 32px 16px 64px 16px;
            }
            .content-section {
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 16px rgba(40, 53, 147, 0.07);
                padding: 30px;
                margin-bottom: 30px;
            }
            .content-section h2 {
                color: #283593;
                border-left: 4px solid #ffb300;
                padding-left: 15px;
                margin-top: 0;
            }
            .content-section h3 {
                color: #444;
                margin-top: 25px;
            }
            .code-block {
                background: #2d3748;
                color: #e2e8f0;
                padding: 15px;
                border-radius: 8px;
                overflow-x: auto;
                margin: 15px 0;
                font-family: 'Courier New', monospace;
            }
            .highlight-box {
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 8px;
                padding: 15px;
                margin: 15px 0;
            }
            .comparison-table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
            }
            .comparison-table th, .comparison-table td {
                border: 1px solid #ddd;
                padding: 12px;
                text-align: left;
            }
            .comparison-table th {
                background-color: #283593;
                color: white;
            }
            .comparison-table tr:nth-child(even) {
                background-color: #f8f9fa;
            }
            .architecture-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
                margin: 20px 0;
            }
            .component-card {
                background: #f8f9fa;
                border: 2px solid #e9ecef;
                border-radius: 10px;
                padding: 20px;
                text-align: center;
            }
            .component-card h4 {
                color: #283593;
                margin-top: 0;
            }

            /* Responsive design for interactive section */
            @media (max-width: 1024px) {
                #main-interactive-container {
                    display: block !important;
                    grid-template-columns: none !important;
                }

                #main-interactive-container > div:last-child {
                    position: static !important;
                    margin-top: 30px;
                }

                .stepper {
                    flex-direction: column;
                    gap: 15px;
                }

                .step-block {
                    min-width: 200px;
                    margin: 0 auto;
                }

                .step-arrow {
                    transform: rotate(90deg);
                    margin: 5px 0;
                }
            }

            @media (max-width: 768px) {
                .stepper {
                    padding: 20px 10px;
                }

                .step-block {
                    min-width: 150px;
                    padding: 15px 12px;
                    min-height: 70px;
                }

                .step-number {
                    font-size: 1.2em;
                }

                .step-title {
                    font-size: 0.8em;
                }
            }
            .header {
                text-align: center;
                margin-bottom: 36px;
            }
            .header h1 {
                font-size: 2.5em;
                color: #283593;
                margin-bottom: 8px;
            }
            .header p {
                font-size: 1.2em;
                color: #444;
                opacity: 0.85;
            }
            .stepper {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 8px;
                margin: 40px 0;
                flex-wrap: wrap;
                background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%);
                padding: 30px 20px;
                border-radius: 20px;
                box-shadow: 0 8px 32px rgba(40, 53, 147, 0.1);
            }
            .step-block {
                background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
                border-radius: 16px;
                box-shadow: 0 6px 20px rgba(40, 53, 147, 0.1);
                padding: 20px 16px;
                min-width: 160px;
                min-height: 80px;
                text-align: center;
                font-weight: 600;
                font-size: 0.95em;
                color: #37474f;
                border: 3px solid #e1f5fe;
                cursor: pointer;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                position: relative;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            .step-block:hover {
                transform: translateY(-4px);
                box-shadow: 0 12px 28px rgba(40, 53, 147, 0.15);
                border-color: #81c784;
            }
            .step-block.active {
                background: linear-gradient(135deg, #ffeb3b 0%, #ffc107 100%);
                border: 3px solid #ff9800;
                color: #bf360c;
                transform: translateY(-8px) scale(1.05);
                box-shadow: 0 16px 40px rgba(255, 152, 0, 0.3);
                z-index: 10;
            }
            .step-block.active::before {
                content: '';
                position: absolute;
                top: -5px;
                left: -5px;
                right: -5px;
                bottom: -5px;
                background: linear-gradient(45deg, #ff9800, #ffc107, #ffeb3b, #ff9800);
                border-radius: 20px;
                z-index: -1;
                animation: glow 2s ease-in-out infinite alternate;
            }
            @keyframes glow {
                from { opacity: 0.5; transform: scale(1); }
                to { opacity: 0.8; transform: scale(1.02); }
            }
            .step-number {
                font-size: 1.4em;
                font-weight: 800;
                margin-bottom: 4px;
                color: #1976d2;
            }
            .step-block.active .step-number {
                color: #bf360c;
            }
            .step-title {
                font-size: 0.85em;
                line-height: 1.2;
                opacity: 0.9;
            }
            .step-arrow {
                font-size: 1.8em;
                color: #90a4ae;
                align-self: center;
                margin: 0 4px;
                transition: all 0.3s ease;
                animation: pulse 2s ease-in-out infinite;
            }
            @keyframes pulse {
                0%, 100% { transform: scale(1); opacity: 0.7; }
                50% { transform: scale(1.1); opacity: 1; }
            }
            .step-arrow.active-arrow {
                color: #ff9800;
                transform: scale(1.2);
            }
            .info-panel {
                background: linear-gradient(135deg, #fffde7 0%, #fff8e1 100%);
                border-radius: 20px;
                box-shadow: 0 8px 32px rgba(255, 193, 7, 0.15);
                border: 2px solid #ffcc02;
                padding: 30px;
                margin: 30px 0;
                min-height: 250px;
                position: relative;
                overflow: hidden;
                transition: all 0.3s ease;
            }
            .info-panel::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 4px;
                background: linear-gradient(90deg, #ff9800, #ffc107, #ffeb3b, #ff9800);
                animation: shimmer 3s ease-in-out infinite;
            }
            @keyframes shimmer {
                0%, 100% { opacity: 0.6; }
                50% { opacity: 1; }
            }
            .info-panel h2 {
                color: #e65100;
                margin-top: 0;
                margin-bottom: 20px;
                font-size: 1.6em;
                font-weight: 700;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            .info-panel h2::before {
                content: 'üîç';
                font-size: 1.2em;
            }
            .info-panel p {
                color: #4e342e;
                line-height: 1.7;
                margin-bottom: 15px;
                font-size: 1.05em;
            }
            .info-panel ul,
            .info-panel ol {
                margin-left: 20px;
                color: #4e342e;
                line-height: 1.6;
            }
            .info-panel li {
                margin-bottom: 8px;
                position: relative;
                padding-left: 20px;
            }
            .info-panel li::before {
                content: '‚ñ∂';
                position: absolute;
                left: 0;
                color: #ff9800;
                font-size: 0.8em;
            }
            .diagram-section {
                margin: 32px 0 0 0;
                text-align: center;
            }
            .diagram-svg {
                max-width: 100%;
                margin: 0 auto;
                display: block;
            }
            .legend {
                margin-top: 18px;
                text-align: center;
                font-size: 0.98em;
                color: #555;
            }
            @media (max-width: 900px) {
                .stepper {
                    flex-direction: column;
                    align-items: stretch;
                }
                .step-arrow {
                    display: none;
                }
            }
        </style>
    </head>
    <body>
        <nav style="background: rgba(0,0,0,0.1); padding: 10px 0; text-align: center;">
            <a href="index.html" style="color: #667eea; text-decoration: none; margin: 0 15px; font-weight: bold;">üè† Big Data Hub</a>
            <a href="hadoop.html" style="color: #ff6b35; text-decoration: none; margin: 0 15px; font-weight: bold;">üîß Hadoop</a>
            <a href="hive.html" style="color: #ffb300; text-decoration: none; margin: 0 15px; font-weight: bold;">üêù Hive</a>
            <a href="spark.html" style="color: #e25a1c; text-decoration: none; margin: 0 15px; font-weight: bold;">‚ö° Spark</a>
        </nav>
        <div class="container">
            <div class="header">
                <h1>üêù Apache Hive: Behind the Scenes of Big Data Warehousing</h1>
                <p>
                    Comprehensive guide to Apache Hive architecture, components, and query processing workflow.<br />
                    Understanding how Hive transforms SQL queries into distributed MapReduce/Tez/Spark jobs.
                </p>
            </div>

            <!-- Introduction Section -->
            <div class="content-section">
                <h2>1. Introduction to Apache Hive</h2>
                <p>Apache Hive is a data warehouse software built on top of Apache Hadoop that facilitates reading, writing, and managing large datasets in distributed storage using SQL-like queries. Hive provides a SQL-like interface called HiveQL (HQL) that gets translated into MapReduce, Tez, or Spark jobs.</p>

                <div class="highlight-box">
                    <strong>Key Innovation:</strong> Hive bridges the gap between traditional SQL databases and big data processing by providing familiar SQL syntax for Hadoop ecosystem.
                </div>

                <h3>1.1 Why Hive?</h3>
                <ul>
                    <li><strong>SQL Familiarity:</strong> Enables SQL developers to work with big data</li>
                    <li><strong>Schema on Read:</strong> Flexible schema definition at query time</li>
                    <li><strong>Scalability:</strong> Handles petabytes of data across thousands of nodes</li>
                    <li><strong>Extensibility:</strong> Custom functions and data formats</li>
                    <li><strong>Integration:</strong> Works with various Hadoop ecosystem tools</li>
                </ul>
            </div>

            <!-- Architecture Overview -->
            <div class="content-section">
                <h2>2. Hive Architecture Components</h2>

                <div class="architecture-grid">
                    <div class="component-card">
                        <h4>üñ•Ô∏è Hive Client</h4>
                        <p>CLI, Beeline, JDBC/ODBC drivers, Web UI for submitting queries</p>
                    </div>
                    <div class="component-card">
                        <h4>üöó Hive Driver</h4>
                        <p>Receives queries, manages sessions, coordinates compilation and execution</p>
                    </div>
                    <div class="component-card">
                        <h4>üîß Compiler</h4>
                        <p>Parses HiveQL, performs semantic analysis, generates execution plan</p>
                    </div>
                    <div class="component-card">
                        <h4>‚ö° Optimizer</h4>
                        <p>Optimizes logical plans using predicate pushdown, join reordering</p>
                    </div>
                    <div class="component-card">
                        <h4>üéØ Execution Engine</h4>
                        <p>Converts plans to MapReduce/Tez/Spark jobs and submits to YARN</p>
                    </div>
                    <div class="component-card">
                        <h4>üóÑÔ∏è Metastore</h4>
                        <p>Stores metadata about tables, partitions, schemas, and locations</p>
                    </div>
                </div>

                <h3>2.1 Metastore Deep Dive</h3>
                <p>The Hive Metastore is a critical component that stores:</p>
                <ul>
                    <li><strong>Table Definitions:</strong> Schema, column types, table properties</li>
                    <li><strong>Partition Information:</strong> Partition keys, locations, statistics</li>
                    <li><strong>Storage Details:</strong> File formats, SerDe information, compression</li>
                    <li><strong>Security Metadata:</strong> Access permissions and ownership</li>
                </ul>

                <div class="code-block">
-- Example: Creating a partitioned table
CREATE TABLE sales_data (
    transaction_id STRING,
    customer_id STRING,
    product_id STRING,
    amount DECIMAL(10,2),
    transaction_time TIMESTAMP
)
PARTITIONED BY (year INT, month INT)
STORED AS PARQUET
LOCATION '/warehouse/sales_data';
                </div>
            </div>

            <!-- HiveQL and Data Types -->
            <div class="content-section">
                <h2>3. HiveQL (Hive Query Language)</h2>

                <h3>3.1 Data Types</h3>
                <table class="comparison-table">
                    <tr>
                        <th>Category</th>
                        <th>Data Types</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Primitive</td>
                        <td>TINYINT, SMALLINT, INT, BIGINT</td>
                        <td>Integer types of various sizes</td>
                    </tr>
                    <tr>
                        <td>Primitive</td>
                        <td>FLOAT, DOUBLE, DECIMAL</td>
                        <td>Floating point and decimal numbers</td>
                    </tr>
                    <tr>
                        <td>Primitive</td>
                        <td>STRING, VARCHAR, CHAR</td>
                        <td>Text data types</td>
                    </tr>
                    <tr>
                        <td>Primitive</td>
                        <td>BOOLEAN, TIMESTAMP, DATE</td>
                        <td>Boolean and temporal types</td>
                    </tr>
                    <tr>
                        <td>Complex</td>
                        <td>ARRAY, MAP, STRUCT</td>
                        <td>Collections and structured data</td>
                    </tr>
                </table>

                <h3>3.2 HiveQL Features</h3>
                <div class="code-block">
-- Complex data type example
CREATE TABLE user_activity (
    user_id STRING,
    actions ARRAY&lt;STRING&gt;,
    preferences MAP&lt;STRING, STRING&gt;,
    profile STRUCT&lt;name:STRING, age:INT, location:STRING&gt;
);

-- Query with complex types
SELECT
    user_id,
    actions[0] as first_action,
    preferences['theme'] as theme_preference,
    profile.name as user_name
FROM user_activity
WHERE size(actions) > 5;
                </div>
            </div>

            <!-- Storage Formats and SerDe -->
            <div class="content-section">
                <h2>4. Storage Formats and SerDe</h2>

                <h3>4.1 File Formats</h3>
                <table class="comparison-table">
                    <tr>
                        <th>Format</th>
                        <th>Type</th>
                        <th>Compression</th>
                        <th>Schema Evolution</th>
                        <th>Use Case</th>
                    </tr>
                    <tr>
                        <td>TextFile</td>
                        <td>Row-based</td>
                        <td>Good</td>
                        <td>Limited</td>
                        <td>Human-readable, debugging</td>
                    </tr>
                    <tr>
                        <td>SequenceFile</td>
                        <td>Row-based</td>
                        <td>Good</td>
                        <td>Limited</td>
                        <td>Binary format, splittable</td>
                    </tr>
                    <tr>
                        <td>RCFile</td>
                        <td>Columnar</td>
                        <td>Excellent</td>
                        <td>Limited</td>
                        <td>Legacy columnar format</td>
                    </tr>
                    <tr>
                        <td>ORC</td>
                        <td>Columnar</td>
                        <td>Excellent</td>
                        <td>Good</td>
                        <td>Optimized for Hive, analytics</td>
                    </tr>
                    <tr>
                        <td>Parquet</td>
                        <td>Columnar</td>
                        <td>Excellent</td>
                        <td>Excellent</td>
                        <td>Cross-platform, analytics</td>
                    </tr>
                </table>

                <h3>4.2 SerDe (Serializer/Deserializer)</h3>
                <p>SerDe determines how Hive reads and writes data:</p>
                <ul>
                    <li><strong>LazySimpleSerDe:</strong> Default for TextFile format</li>
                    <li><strong>JsonSerDe:</strong> For JSON data processing</li>
                    <li><strong>RegexSerDe:</strong> For parsing log files with regex patterns</li>
                    <li><strong>AvroSerDe:</strong> For Avro format data</li>
                    <li><strong>ParquetHiveSerDe:</strong> For Parquet format</li>
                </ul>

                <div class="code-block">
-- Custom SerDe example for JSON data
CREATE TABLE json_table (
    id STRING,
    name STRING,
    details MAP&lt;STRING, STRING&gt;
)
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
STORED AS TEXTFILE;
                </div>
            </div>

            <!-- Partitioning and Bucketing -->
            <div class="content-section">
                <h2>5. Partitioning and Bucketing</h2>

                <h3>5.1 Partitioning</h3>
                <p>Partitioning divides tables into smaller, manageable pieces based on column values:</p>
                <ul>
                    <li><strong>Static Partitioning:</strong> Partition values specified at insert time</li>
                    <li><strong>Dynamic Partitioning:</strong> Partition values determined from data</li>
                    <li><strong>Benefits:</strong> Query pruning, parallel processing, faster queries</li>
                </ul>

                <div class="code-block">
-- Dynamic partitioning example
SET hive.exec.dynamic.partition = true;
SET hive.exec.dynamic.partition.mode = nonstrict;

INSERT INTO TABLE sales_partitioned
PARTITION (year, month)
SELECT transaction_id, customer_id, amount, year, month
FROM sales_raw;
                </div>

                <h3>5.2 Bucketing</h3>
                <p>Bucketing distributes data into fixed number of files based on hash function:</p>
                <ul>
                    <li><strong>Even Distribution:</strong> Ensures uniform data distribution</li>
                    <li><strong>Join Optimization:</strong> Enables map-side joins</li>
                    <li><strong>Sampling:</strong> Efficient data sampling for analysis</li>
                </ul>

                <div class="code-block">
-- Bucketed table example
CREATE TABLE user_bucketed (
    user_id STRING,
    name STRING,
    email STRING
)
CLUSTERED BY (user_id) INTO 32 BUCKETS
STORED AS ORC;
                </div>
            </div>

            <!-- Query Optimization -->
            <div class="content-section">
                <h2>6. Query Optimization Techniques</h2>

                <h3>6.1 Cost-Based Optimizer (CBO)</h3>
                <p>Hive's CBO uses statistics to generate optimal execution plans:</p>
                <ul>
                    <li><strong>Table Statistics:</strong> Row count, file size, partition info</li>
                    <li><strong>Column Statistics:</strong> Distinct values, null count, min/max values</li>
                    <li><strong>Join Optimization:</strong> Optimal join order and algorithms</li>
                </ul>

                <div class="code-block">
-- Generating statistics for CBO
ANALYZE TABLE sales_data COMPUTE STATISTICS;
ANALYZE TABLE sales_data COMPUTE STATISTICS FOR COLUMNS;

-- Check statistics
DESCRIBE FORMATTED sales_data;
                </div>

                <h3>6.2 Optimization Techniques</h3>
                <ul>
                    <li><strong>Predicate Pushdown:</strong> Push filters to storage layer</li>
                    <li><strong>Projection Pushdown:</strong> Read only required columns</li>
                    <li><strong>Partition Pruning:</strong> Skip irrelevant partitions</li>
                    <li><strong>Join Optimization:</strong> Map-side joins, bucket joins</li>
                    <li><strong>Vectorization:</strong> Process data in batches for better CPU utilization</li>
                </ul>

                <div class="code-block">
-- Vectorization settings
SET hive.vectorized.execution.enabled = true;
SET hive.vectorized.execution.reduce.enabled = true;

-- Map-side join optimization
SET hive.auto.convert.join = true;
SET hive.mapjoin.smalltable.filesize = 25000000;
                </div>
            </div>

            <!-- Execution Engines -->
            <div class="content-section">
                <h2>7. Execution Engines</h2>

                <table class="comparison-table">
                    <tr>
                        <th>Engine</th>
                        <th>Processing Model</th>
                        <th>Performance</th>
                        <th>Memory Usage</th>
                        <th>Best For</th>
                    </tr>
                    <tr>
                        <td>MapReduce</td>
                        <td>Batch, disk-based</td>
                        <td>Slow</td>
                        <td>Low</td>
                        <td>Large batch jobs, fault tolerance</td>
                    </tr>
                    <tr>
                        <td>Tez</td>
                        <td>DAG, in-memory</td>
                        <td>Fast</td>
                        <td>Medium</td>
                        <td>Interactive queries, complex workflows</td>
                    </tr>
                    <tr>
                        <td>Spark</td>
                        <td>In-memory, iterative</td>
                        <td>Very Fast</td>
                        <td>High</td>
                        <td>Machine learning, iterative algorithms</td>
                    </tr>
                </table>

                <div class="code-block">
-- Setting execution engine
SET hive.execution.engine = tez;  -- or mapreduce, spark

-- Tez-specific optimizations
SET hive.tez.container.size = 4096;
SET hive.tez.java.opts = -Xmx3276m;
                </div>
            </div>

            <!-- Performance Tuning -->
            <div class="content-section">
                <h2>8. Performance Tuning Best Practices</h2>

                <h3>8.1 Configuration Tuning</h3>
                <div class="code-block">
-- Memory and parallelism settings
SET mapreduce.map.memory.mb = 4096;
SET mapreduce.reduce.memory.mb = 8192;
SET mapreduce.job.reduces = 200;

-- Compression settings
SET hive.exec.compress.output = true;
SET mapreduce.output.fileoutputformat.compress.codec = org.apache.hadoop.io.compress.SnappyCodec;

-- Optimization settings
SET hive.optimize.ppd = true;  -- Predicate pushdown
SET hive.optimize.cp = true;   -- Column pruning
SET hive.cbo.enable = true;    -- Cost-based optimizer
                </div>

                <h3>8.2 Query Design Best Practices</h3>
                <ul>
                    <li><strong>Use appropriate file formats:</strong> ORC/Parquet for analytics</li>
                    <li><strong>Partition wisely:</strong> Avoid too many small partitions</li>
                    <li><strong>Use bucketing:</strong> For large tables with frequent joins</li>
                    <li><strong>Optimize joins:</strong> Put smaller tables on the right side</li>
                    <li><strong>Use LIMIT:</strong> For exploratory queries</li>
                    <li><strong>Avoid SELECT *:</strong> Specify only needed columns</li>
                </ul>
            </div>

            <!-- Security and Governance -->
            <div class="content-section">
                <h2>9. Security and Governance</h2>

                <h3>9.1 Authentication and Authorization</h3>
                <ul>
                    <li><strong>Kerberos:</strong> Strong authentication for secure clusters</li>
                    <li><strong>LDAP/AD Integration:</strong> Enterprise user management</li>
                    <li><strong>Apache Ranger:</strong> Fine-grained access control</li>
                    <li><strong>Apache Sentry:</strong> Role-based authorization (deprecated)</li>
                </ul>

                <h3>9.2 Data Governance</h3>
                <ul>
                    <li><strong>Apache Atlas:</strong> Data lineage and metadata management</li>
                    <li><strong>Data Classification:</strong> Sensitive data identification</li>
                    <li><strong>Audit Logging:</strong> Track data access and modifications</li>
                    <li><strong>Data Masking:</strong> Protect sensitive information</li>
                </ul>
            </div>

            <!-- Hive vs Other Technologies -->
            <div class="content-section">
                <h2>10. Hive vs Other Big Data Technologies</h2>

                <table class="comparison-table">
                    <tr>
                        <th>Aspect</th>
                        <th>Hive</th>
                        <th>Spark SQL</th>
                        <th>Presto/Trino</th>
                        <th>Impala</th>
                    </tr>
                    <tr>
                        <td>Query Language</td>
                        <td>HiveQL (SQL-like)</td>
                        <td>ANSI SQL</td>
                        <td>ANSI SQL</td>
                        <td>SQL</td>
                    </tr>
                    <tr>
                        <td>Processing Model</td>
                        <td>Batch (MR/Tez/Spark)</td>
                        <td>In-memory, batch/streaming</td>
                        <td>MPP, in-memory</td>
                        <td>MPP, in-memory</td>
                    </tr>
                    <tr>
                        <td>Latency</td>
                        <td>High (minutes)</td>
                        <td>Medium (seconds)</td>
                        <td>Low (sub-second)</td>
                        <td>Low (sub-second)</td>
                    </tr>
                    <tr>
                        <td>Fault Tolerance</td>
                        <td>Excellent</td>
                        <td>Good</td>
                        <td>Limited</td>
                        <td>Limited</td>
                    </tr>
                    <tr>
                        <td>Best Use Case</td>
                        <td>ETL, batch analytics</td>
                        <td>Unified analytics</td>
                        <td>Interactive analytics</td>
                        <td>Real-time analytics</td>
                    </tr>
                </table>
            </div>

            <!-- Unified Interactive Architecture & Workflow Section -->
            <div class="content-section">
                <h2>11. How Hive Works: Interactive Architecture & Query Processing</h2>
                <p style="text-align: center; font-size: 1.1em; color: #666; margin-bottom: 30px;">
                    üéØ <strong>Explore the complete journey</strong> of how Hive transforms your SQL queries into distributed processing jobs.<br>
                    Click components, follow the workflow, and understand the architecture behind the scenes.
                </p>

                <!-- Unified Control Panel -->
                <div style="background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); border: 2px solid #2196f3; border-radius: 15px; padding: 20px; margin: 20px 0; text-align: center;">
                    <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button id="architecture-view-btn" onclick="showArchitectureView()" style="background: #2196f3; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                            üèóÔ∏è Architecture View
                        </button>
                        <button id="workflow-view-btn" onclick="showWorkflowView()" style="background: #4caf50; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                            üîÑ Query Workflow
                        </button>
                        <button id="integrated-view-btn" onclick="showIntegratedView()" style="background: #ff9800; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                            üéØ Integrated View
                        </button>
                    </div>
                    <div style="font-size: 0.9em; color: #666;">
                        <strong>Architecture:</strong> Explore components ‚Ä¢ <strong>Workflow:</strong> Step-by-step processing ‚Ä¢ <strong>Integrated:</strong> See how they work together
                    </div>
                </div>
                <!-- Main Unified Container -->
                <div id="unified-container" style="background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%); border-radius: 20px; padding: 30px; margin: 20px 0; border: 2px solid #2196f3; position: relative; overflow: hidden; min-height: 700px;">

                    <!-- Architecture View (Enhanced Interactive Architecture) -->
                    <div id="architecture-view" style="display: block;">
                        <h3 style="text-align: center; color: #1976d2; margin-bottom: 30px;">üèóÔ∏è Interactive Hive Architecture</h3>

                        <!-- Simplified Interactive Architecture for Unified View -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
                            <!-- Client Component -->
                            <div class="unified-component" onclick="showUnifiedComponentDetails('client')" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: 3px solid #2196f3; border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 10px;">üñ•Ô∏è</div>
                                <h4 style="margin: 10px 0; color: #1976d2;">Hive Client</h4>
                                <p style="font-size: 0.9em; color: #666; margin: 0;">CLI, Beeline, JDBC/ODBC drivers, Web UI</p>
                            </div>

                            <!-- Driver Component -->
                            <div class="unified-component" onclick="showUnifiedComponentDetails('driver')" style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border: 3px solid #4caf50; border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 10px;">üöó</div>
                                <h4 style="margin: 10px 0; color: #2e7d32;">Hive Driver</h4>
                                <p style="font-size: 0.9em; color: #666; margin: 0;">Session management & coordination</p>
                            </div>

                            <!-- Compiler Component -->
                            <div class="unified-component" onclick="showUnifiedComponentDetails('compiler')" style="background: linear-gradient(135deg, #fff3e0 0%, #ffcc80 100%); border: 3px solid #ff9800; border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 10px;">üîß</div>
                                <h4 style="margin: 10px 0; color: #f57c00;">Compiler</h4>
                                <p style="font-size: 0.9em; color: #666; margin: 0;">Parse & semantic analysis</p>
                            </div>

                            <!-- Optimizer Component -->
                            <div class="unified-component" onclick="showUnifiedComponentDetails('optimizer')" style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); border: 3px solid #9c27b0; border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 10px;">‚ö°</div>
                                <h4 style="margin: 10px 0; color: #7b1fa2;">Optimizer</h4>
                                <p style="font-size: 0.9em; color: #666; margin: 0;">Query optimization</p>
                            </div>

                            <!-- Execution Engine Component -->
                            <div class="unified-component" onclick="showUnifiedComponentDetails('execution')" style="background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%); border: 3px solid #03a9f4; border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 10px;">üéØ</div>
                                <h4 style="margin: 10px 0; color: #0277bd;">Execution Engine</h4>
                                <p style="font-size: 0.9em; color: #666; margin: 0;">Job creation & submission</p>
                            </div>

                            <!-- Metastore Component -->
                            <div class="unified-component" onclick="showUnifiedComponentDetails('metastore')" style="background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%); border: 3px solid #009688; border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 10px;">üóÑÔ∏è</div>
                                <h4 style="margin: 10px 0; color: #00695c;">Metastore</h4>
                                <p style="font-size: 0.9em; color: #666; margin: 0;">Metadata storage</p>
                            </div>
                        </div>

                        <!-- Architecture Flow Visualization -->
                        <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.8); border-radius: 15px; border: 2px dashed #2196f3;">
                            <h4 style="text-align: center; color: #1976d2; margin-top: 0;">üîÑ Component Interaction Flow</h4>
                            <div style="display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 15px;">
                                <span style="background: #e3f2fd; padding: 8px 12px; border-radius: 20px; color: #1976d2; font-weight: bold;">Client</span>
                                <span style="color: #2196f3; font-size: 1.5em;">‚Üí</span>
                                <span style="background: #e8f5e9; padding: 8px 12px; border-radius: 20px; color: #2e7d32; font-weight: bold;">Driver</span>
                                <span style="color: #4caf50; font-size: 1.5em;">‚Üí</span>
                                <span style="background: #fff3e0; padding: 8px 12px; border-radius: 20px; color: #f57c00; font-weight: bold;">Compiler</span>
                                <span style="color: #ff9800; font-size: 1.5em;">‚Üí</span>
                                <span style="background: #f3e5f5; padding: 8px 12px; border-radius: 20px; color: #7b1fa2; font-weight: bold;">Optimizer</span>
                                <span style="color: #9c27b0; font-size: 1.5em;">‚Üí</span>
                                <span style="background: #e1f5fe; padding: 8px 12px; border-radius: 20px; color: #0277bd; font-weight: bold;">Execution</span>
                            </div>
                            <div style="text-align: center; margin-top: 15px; color: #666;">
                                <small>üí° Click any component above to see detailed information and its role in query processing</small>
                            </div>
                        </div>
                    </div>

                    <!-- Workflow View -->
                    <div id="workflow-view" style="display: none;">
                        <h3 style="text-align: center; color: #4caf50; margin-bottom: 30px;">üîÑ Query Processing Workflow</h3>

                        <!-- Stepper Navigation -->
                        <div class="stepper" id="hive-stepper" style="margin-bottom: 30px;">
                            <div class="step-block active" onclick="showStep(0)">
                                <div class="step-number">1</div>
                                <div class="step-title">Query Submission</div>
                            </div>
                            <span class="step-arrow">‚Üí</span>
                            <div class="step-block" onclick="showStep(1)">
                                <div class="step-number">2</div>
                                <div class="step-title">Compilation</div>
                            </div>
                            <span class="step-arrow">‚Üí</span>
                            <div class="step-block" onclick="showStep(2)">
                                <div class="step-number">3</div>
                                <div class="step-title">Optimization</div>
                            </div>
                            <span class="step-arrow">‚Üí</span>
                            <div class="step-block" onclick="showStep(3)">
                                <div class="step-number">4</div>
                                <div class="step-title">Execution</div>
                            </div>
                            <span class="step-arrow">‚Üí</span>
                            <div class="step-block" onclick="showStep(4)">
                                <div class="step-number">5</div>
                                <div class="step-title">Job Processing</div>
                            </div>
                            <span class="step-arrow">‚Üí</span>
                            <div class="step-block" onclick="showStep(5)">
                                <div class="step-number">6</div>
                                <div class="step-title">Result Fetching</div>
                            </div>
                        </div>

                        <!-- Progress Indicator -->
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="background: #e0e0e0; height: 6px; border-radius: 3px; max-width: 600px; margin: 0 auto; position: relative;">
                                <div id="progress-bar" style="background: linear-gradient(90deg, #ff9800, #ffc107); height: 100%; border-radius: 3px; width: 16.67%; transition: width 0.3s ease;"></div>
                            </div>
                            <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                                Step <span id="current-step">1</span> of 6
                            </div>
                        </div>

                        <!-- Workflow Content Area -->
                        <div style="display: grid; grid-template-columns: 1fr 350px; gap: 20px;">
                            <div id="visual-diagrams-area" style="background: rgba(255,255,255,0.8); border-radius: 15px; padding: 25px; min-height: 400px;">
                                <h4 style="color: #1976d2; margin-bottom: 20px; text-align: center;">üîç Step Visualization</h4>
                                <div style="text-align: center; color: #666;">
                                    Click on any step above to see detailed workflow visualization
                                </div>
                            </div>

                            <div id="workflow-info-panel" style="background: rgba(255,255,255,0.9); border-radius: 15px; padding: 20px;">
                                <div id="info-panel" class="info-panel" style="background: none; box-shadow: none; padding: 0;">
                                    <h4 style="color: #4caf50; margin-top: 0;">üöÄ Query Processing</h4>
                                    <p>Click on any step to see how Hive processes your queries behind the scenes.</p>

                                    <!-- Navigation Buttons -->
                                    <div style="text-align: center; margin: 20px 0;">
                                        <button id="prev-btn" onclick="navigateStep(-1)" style="background: #2196f3; color: white; border: none; padding: 8px 16px; border-radius: 20px; margin: 0 5px; cursor: pointer; font-size: 0.9em;" disabled>
                                            ‚Üê Prev
                                        </button>
                                        <button id="next-btn" onclick="navigateStep(1)" style="background: #4caf50; color: white; border: none; padding: 8px 16px; border-radius: 20px; margin: 0 5px; cursor: pointer; font-size: 0.9em;">
                                            Next ‚Üí
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Integrated View -->
                    <div id="integrated-view" style="display: none;">
                        <h3 style="text-align: center; color: #ff9800; margin-bottom: 30px;">üéØ Architecture + Workflow Integration</h3>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 600px;">
                            <!-- Left: Simplified Architecture -->
                            <div style="background: rgba(255,255,255,0.8); border-radius: 15px; padding: 20px; border: 2px solid #2196f3;">
                                <h4 style="color: #2196f3; text-align: center; margin-bottom: 15px;">üèóÔ∏è Components</h4>
                                <div id="integrated-architecture" style="height: 500px; overflow-y: auto;">
                                    <div style="text-align: center; color: #666; margin: 50px 0;">
                                        <p>üîó <strong>Interactive components from Section 2</strong></p>
                                        <p>Click components above to see their role in query processing</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Right: Simplified Workflow -->
                            <div style="background: rgba(255,255,255,0.8); border-radius: 15px; padding: 20px; border: 2px solid #4caf50;">
                                <h4 style="color: #4caf50; text-align: center; margin-bottom: 15px;">üîÑ Processing Flow</h4>
                                <div id="integrated-workflow" style="height: 500px; overflow-y: auto;">
                                    <div style="text-align: center; color: #666; margin: 50px 0;">
                                        <p>üìã <strong>Query processing steps</strong></p>
                                        <p>Switch to Workflow View for detailed step-by-step exploration</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Connection Visualization -->
                        <div style="margin-top: 20px; text-align: center; background: rgba(255,255,255,0.9); border-radius: 15px; padding: 20px;">
                            <h4 style="color: #ff9800; margin-top: 0;">üîó How Components Drive the Workflow</h4>
                            <p style="color: #666;">This integrated view shows how architectural components work together to process queries.</p>
                        </div>
                    </div>
                </div>

                <!-- Unified Info Panel -->
                <div id="unified-info-panel" style="background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%); border-radius: 15px; padding: 25px; margin-top: 20px; box-shadow: 0 4px 16px rgba(40, 53, 147, 0.07); display: none;">
                    <h3 id="unified-info-title">Component/Step Details</h3>
                    <div id="unified-info-content">
                        Select a component or workflow step to see detailed information.
                    </div>
                </div>
            </div>



        </div>
        <script>
            // Step-by-step explanations for each phase
            const hiveSteps = [
                {
                    title: "Query Submission",
                    html: `
                    <h2>1. Query Submission</h2>
                    <p>
                        The user submits a HiveQL query using the Hive CLI, Beeline, JDBC/ODBC, Web UI, or a custom application.<br>
                        <b>Client</b> sends the query to the <b>Hive Driver</b> for processing.
                    </p>
                    <ol>
                        <li>User writes HiveQL query in CLI, Beeline, JDBC, or Web UI.</li>
                        <li>Client establishes a session (authentication, authorization).</li>
                        <li>Query is sent to HiveServer2 (or HiveServer).</li>
                        <li>HiveServer2 forwards the query to the Driver.</li>
                    </ol>
                    <ul>
                        <li><b>Interfaces:</b> CLI, Beeline, JDBC, Web UI, etc.</li>
                        <li><b>Query format:</b> SQL-like HiveQL.</li>
                    </ul>

                `,
                },
                {
                    title: "Compilation",
                    html: `
                    <h2>2. Compilation</h2>
                    <p>
                        The <b>Driver</b> forwards the query to the <b>Compiler</b>.<br>
                        The Compiler parses the HiveQL, checks syntax and semantics, and creates an execution plan (DAG of stages).
                    </p>
                    <ol>
                        <li>Driver receives the query from the client.</li>
                        <li>Parser checks HiveQL syntax and builds an Abstract Syntax Tree (AST).</li>
                        <li>Semantic analyzer validates tables, columns, and types using the Metastore.</li>
                        <li>Logical plan (DAG) is generated from the AST.</li>
                    </ol>
                    <ul>
                        <li>Consults the <b>Metastore</b> for table and column metadata.</li>
                        <li>Generates a logical plan for execution.</li>
                    </ul>
                `,
                },
                {
                    title: "Optimization",
                    html: `
                    <h2>3. Optimization</h2>
                    <p>
                        The <b>Optimizer</b> improves the logical plan for efficiency.<br>
                        This may include predicate pushdown, join reordering, and partition pruning.
                    </p>
                    <ol>
                        <li>Logical plan is analyzed for optimization opportunities.</li>
                        <li>Predicate pushdown: Filters are applied as early as possible.</li>
                        <li>Partition pruning: Only relevant partitions are scanned.</li>
                        <li>Column pruning: Only necessary columns are read.</li>
                        <li>Join reordering: Joins are rearranged for efficiency.</li>
                        <li>Optimized logical plan is converted to a physical plan.</li>
                    </ol>
                `,
                },
                {
                    title: "Execution",
                    html: `
                    <h2>4. Execution</h2>
                    <p>
                        The <b>Execution Engine</b> converts the optimized plan into physical jobs.<br>
                        These jobs can run on MapReduce, Tez, or Spark, and are submitted to Hadoop YARN for resource management.
                    </p>
                    <ol>
                        <li>Physical plan is translated into one or more execution stages (MapReduce, Tez, or Spark jobs).</li>
                        <li>Execution engine builds a DAG of tasks.</li>
                        <li>Jobs are submitted to YARN for resource allocation and scheduling.</li>
                        <li>Each stage may depend on the output of previous stages.</li>
                    </ol>
                `,
                },
                {
                    title: "Job Processing",
                    html: `
                    <h2>5. Job Processing</h2>
                    <p>
                        The jobs are executed on the Hadoop cluster.<br>
                        Data is read from <b>HDFS</b>, processed in parallel by Map and Reduce tasks (or Tez/Spark DAGs), and intermediate results may be written back to HDFS.
                    </p>
                    <ol>
                        <li>YARN allocates containers for each job stage.</li>
                        <li>Map tasks read data splits from HDFS.</li>
                        <li>Shuffle and sort phase (if needed) organizes intermediate data.</li>
                        <li>Reduce tasks aggregate and process results.</li>
                        <li>Intermediate results may be written to HDFS between stages.</li>
                        <li>Final output is written to HDFS or a temporary location.</li>
                    </ol>
                `,
                },
                {
                    title: "Result Fetching",
                    html: `
                    <h2>6. Result Fetching</h2>
                    <p>
                        The final result is collected by the <b>Driver</b> and returned to the user.<br>
                        Results can be displayed in the CLI, written to a file, or sent to an application.
                    </p>
                    <ol>
                        <li>Driver fetches the final output from HDFS or temporary storage.</li>
                        <li>Results are formatted for the client (table, CSV, etc.).</li>
                        <li>User receives the query result in the CLI, file, or API response.</li>
                        <li>Session may be closed or kept alive for further queries.</li>
                    </ol>

               `,
                },
            ];

            function showStep(idx) {
                // Highlight the selected step
                const blocks = document.querySelectorAll(".step-block");
                const arrows = document.querySelectorAll(".step-arrow");

                blocks.forEach((block, i) => {
                    if (i === idx) {
                        block.classList.add("active");
                    } else {
                        block.classList.remove("active");
                    }
                });

                // Highlight arrows leading to active step
                arrows.forEach((arrow, i) => {
                    if (i < idx) {
                        arrow.classList.add("active-arrow");
                    } else {
                        arrow.classList.remove("active-arrow");
                    }
                });



                // Update info panel with smooth transition
                const infoPanel = document.getElementById("info-panel");
                const mobileInfoPanel = document.getElementById("mobile-info-panel");

                infoPanel.style.opacity = "0.5";
                infoPanel.style.transform = "translateY(10px)";

                setTimeout(() => {
                    infoPanel.innerHTML = hiveSteps[idx].html;
                    if (mobileInfoPanel) {
                        mobileInfoPanel.innerHTML = hiveSteps[idx].html;
                    }
                    infoPanel.style.opacity = "1";
                    infoPanel.style.transform = "translateY(0)";
                }, 150);

                // Update progress indicator
                updateProgressIndicator(idx);

                // Show sub-steps automatically for the current step
                const visualArea = document.getElementById("visual-diagrams-area");
                if (visualArea) {
                    showSubStepsForStep(idx, visualArea);
                }
            }

            let currentStepIndex = 0;

            function updateProgressIndicator(stepIndex) {
                currentStepIndex = stepIndex;
                const progressBar = document.getElementById("progress-bar");
                const currentStepSpan = document.getElementById("current-step");
                const prevBtn = document.getElementById("prev-btn");
                const nextBtn = document.getElementById("next-btn");

                // Update progress bar width
                const progressWidth = ((stepIndex + 1) / 6) * 100;
                progressBar.style.width = progressWidth + "%";

                // Update step counter
                currentStepSpan.textContent = stepIndex + 1;

                // Update button states
                prevBtn.disabled = stepIndex === 0;
                nextBtn.disabled = stepIndex === 5;

                // Update button styles based on state
                if (prevBtn.disabled) {
                    prevBtn.style.opacity = "0.5";
                    prevBtn.style.cursor = "not-allowed";
                } else {
                    prevBtn.style.opacity = "1";
                    prevBtn.style.cursor = "pointer";
                }

                if (nextBtn.disabled) {
                    nextBtn.style.opacity = "0.5";
                    nextBtn.style.cursor = "not-allowed";
                } else {
                    nextBtn.style.opacity = "1";
                    nextBtn.style.cursor = "pointer";
                }
            }

            function navigateStep(direction) {
                const newIndex = currentStepIndex + direction;
                if (newIndex >= 0 && newIndex < 6) {
                    showStep(newIndex);
                }
            }

            function showSubStepsForStep(stepIndex, visualArea) {
                // Create container for sub-steps
                let subStepsContainer = document.getElementById("current-substeps");
                if (!subStepsContainer) {
                    subStepsContainer = document.createElement("div");
                    subStepsContainer.id = "current-substeps";
                    subStepsContainer.style.cssText = `
                        background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%);
                        border-radius: 15px;
                        padding: 20px;
                        margin: 20px 0;
                        border: 2px solid #2196f3;
                    `;
                    visualArea.appendChild(subStepsContainer);
                } else {
                    // Clear existing content
                    subStepsContainer.innerHTML = "";
                }

                // Show appropriate sub-steps based on current step
                switch(stepIndex) {
                    case 0:
                        showQSVisualInline(subStepsContainer);
                        break;
                    case 1:
                        showCompVisualInline(subStepsContainer);
                        break;
                    case 2:
                        showOptVisualInline(subStepsContainer);
                        break;
                    case 3:
                        showExecVisualInline(subStepsContainer);
                        break;
                    case 4:
                        showJobVisualInline(subStepsContainer);
                        break;
                    case 5:
                        showResVisualInline(subStepsContainer);
                        break;
                }

                // Scroll to sub-steps with a slight delay to ensure content is rendered
                setTimeout(() => {
                    subStepsContainer.scrollIntoView({
                        behavior: "smooth",
                        block: "center"
                    });
                }, 100);
            }

            // Responsive design handling
            function handleResponsiveLayout() {
                const mainContainer = document.getElementById("main-interactive-container");
                const mobileLayout = document.getElementById("mobile-layout");

                if (window.innerWidth < 1024) {
                    // Switch to mobile layout
                    mainContainer.style.display = "none";
                    mobileLayout.style.display = "block";

                    // Update mobile info panel with current step
                    const mobileInfoPanel = document.getElementById("mobile-info-panel");
                    const infoPanel = document.getElementById("info-panel");
                    if (mobileInfoPanel && infoPanel) {
                        mobileInfoPanel.innerHTML = infoPanel.innerHTML;
                    }
                } else {
                    // Switch to desktop layout
                    mainContainer.style.display = "grid";
                    mobileLayout.style.display = "none";
                }
            }

            // Inline sub-step visualization functions
            function showQSVisualInline(container) {
                container.innerHTML = `
                    <h4 style="color: #1976d2; margin-top: 0;">üîç Query Submission Sub-Steps</h4>
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; flex: 1; min-width: 200px; text-align: center;">
                            <div style="font-size: 2em;">üë§</div>
                            <div><strong>User Input</strong></div>
                            <div style="font-size: 0.9em; color: #666;">HiveQL query via CLI/UI</div>
                        </div>
                        <div style="font-size: 1.5em; color: #2196f3;">‚Üí</div>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; flex: 1; min-width: 200px; text-align: center;">
                            <div style="font-size: 2em;">üîê</div>
                            <div><strong>Authentication</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Session establishment</div>
                        </div>
                        <div style="font-size: 1.5em; color: #2196f3;">‚Üí</div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 10px; flex: 1; min-width: 200px; text-align: center;">
                            <div style="font-size: 2em;">üì°</div>
                            <div><strong>HiveServer2</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Query reception</div>
                        </div>
                        <div style="font-size: 1.5em; color: #2196f3;">‚Üí</div>
                        <div style="background: #f3e5f5; padding: 15px; border-radius: 10px; flex: 1; min-width: 200px; text-align: center;">
                            <div style="font-size: 2em;">üöó</div>
                            <div><strong>Driver</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Query forwarding</div>
                        </div>
                    </div>
                `;
            }

            function showCompVisualInline(container) {
                container.innerHTML = `
                    <h4 style="color: #8e24aa; margin-top: 0;">üîç Compilation Sub-Steps</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: #f3e5f5; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üì®</div>
                            <div><strong>Query Reception</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Driver receives HiveQL</div>
                        </div>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üõ†Ô∏è</div>
                            <div><strong>Parsing</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Syntax check & AST creation</div>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üóÇÔ∏è</div>
                            <div><strong>Semantic Analysis</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Metastore validation</div>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üß©</div>
                            <div><strong>Logical Plan</strong></div>
                            <div style="font-size: 0.9em; color: #666;">DAG generation</div>
                        </div>
                    </div>
                `;
            }

            function showOptVisualInline(container) {
                container.innerHTML = `
                    <h4 style="color: #388e3c; margin-top: 0;">üîç Optimization Sub-Steps</h4>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; background: #e8f5e8; padding: 15px; border-radius: 10px;">
                            <div style="text-align: center;">
                                <div style="font-size: 2em;">üìä</div>
                                <div><strong>Statistics Analysis</strong></div>
                            </div>
                            <div style="font-size: 1.5em; color: #4caf50;">‚Üí</div>
                            <div style="text-align: center;">
                                <div style="font-size: 2em;">üîÑ</div>
                                <div><strong>Rule-based Optimization</strong></div>
                            </div>
                            <div style="font-size: 1.5em; color: #4caf50;">‚Üí</div>
                            <div style="text-align: center;">
                                <div style="font-size: 2em;">üí∞</div>
                                <div><strong>Cost-based Optimization</strong></div>
                            </div>
                        </div>
                        <div style="background: #f3e5f5; padding: 15px; border-radius: 10px;">
                            <strong>Optimization Techniques:</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Predicate pushdown</li>
                                <li>Join reordering</li>
                                <li>Column pruning</li>
                                <li>Partition pruning</li>
                            </ul>
                        </div>
                    </div>
                `;
            }

            function showExecVisualInline(container) {
                container.innerHTML = `
                    <h4 style="color: #0288d1; margin-top: 0;">üîç Execution Planning Sub-Steps</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 2em; text-align: center;">üó∫Ô∏è</div>
                            <div><strong>Physical Plan Generation</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Convert logical to physical plan</div>
                        </div>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 2em; text-align: center;">‚öôÔ∏è</div>
                            <div><strong>Engine Selection</strong></div>
                            <div style="font-size: 0.9em; color: #666;">MapReduce/Tez/Spark</div>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 10px;">
                            <div style="font-size: 2em; text-align: center;">üìã</div>
                            <div><strong>Job Configuration</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Resource allocation settings</div>
                        </div>
                    </div>
                `;
            }

            function showJobVisualInline(container) {
                container.innerHTML = `
                    <h4 style="color: #c2185b; margin-top: 0;">üîç Job Processing Sub-Steps</h4>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; background: #fce4ec; padding: 15px; border-radius: 10px; flex-wrap: wrap;">
                            <div style="text-align: center; margin: 5px;">
                                <div style="font-size: 2em;">üèóÔ∏è</div>
                                <div><strong>YARN Allocation</strong></div>
                            </div>
                            <div style="font-size: 1.5em; color: #e91e63;">‚Üí</div>
                            <div style="text-align: center; margin: 5px;">
                                <div style="font-size: 2em;">üìñ</div>
                                <div><strong>Map Tasks</strong></div>
                            </div>
                            <div style="font-size: 1.5em; color: #e91e63;">‚Üí</div>
                            <div style="text-align: center; margin: 5px;">
                                <div style="font-size: 2em;">üîÑ</div>
                                <div><strong>Shuffle & Sort</strong></div>
                            </div>
                            <div style="font-size: 1.5em; color: #e91e63;">‚Üí</div>
                            <div style="text-align: center; margin: 5px;">
                                <div style="font-size: 2em;">üìä</div>
                                <div><strong>Reduce Tasks</strong></div>
                            </div>
                        </div>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 10px;">
                            <strong>Processing Details:</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Data splits processed in parallel</li>
                                <li>Intermediate results stored in HDFS</li>
                                <li>Multiple stages for complex queries</li>
                                <li>Fault tolerance through task retry</li>
                            </ul>
                        </div>
                    </div>
                `;
            }

            function showResVisualInline(container) {
                container.innerHTML = `
                    <h4 style="color: #5e35b1; margin-top: 0;">üîç Result Processing Sub-Steps</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: #ede7f6; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üì•</div>
                            <div><strong>Result Fetching</strong></div>
                            <div style="font-size: 0.9em; color: #666;">From HDFS/temp storage</div>
                        </div>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üìù</div>
                            <div><strong>Formatting</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Table/CSV/JSON format</div>
                        </div>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üì§</div>
                            <div><strong>Client Delivery</strong></div>
                            <div style="font-size: 0.9em; color: #666;">CLI/UI/API response</div>
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em;">üîö</div>
                            <div><strong>Session Management</strong></div>
                            <div style="font-size: 0.9em; color: #666;">Close or keep alive</div>
                        </div>
                    </div>
                `;
            }


            // --- Interactive Sub-Steps Data ---
            const compStepData = [
                { icon: "üì®", label: "Driver receives query from client." },
                {
                    icon: "üõ†Ô∏è",
                    label: "Parser checks HiveQL syntax, builds AST.",
                },
                {
                    icon: "üóÇÔ∏è",
                    label: "Semantic analyzer validates tables/columns via Metastore.",
                },
                { icon: "üß©", label: "Logical plan (DAG) is generated." },
            ];
            const compStepDesc = [
                "Driver receives the query from the client.",
                "Parser checks HiveQL syntax and builds an Abstract Syntax Tree (AST).",
                "Semantic analyzer validates tables, columns, and types using the Metastore.",
                "Logical plan (DAG) is generated from the AST.",
            ];

            const optStepData = [
                {
                    icon: "üîç",
                    label: "Analyze logical plan for optimizations.",
                },
                {
                    icon: "üè∑Ô∏è",
                    label: "Predicate pushdown (apply filters early).",
                },
                {
                    icon: "üóÉÔ∏è",
                    label: "Partition pruning (scan only relevant partitions).",
                },
                {
                    icon: "üìâ",
                    label: "Column pruning (read only needed columns).",
                },
                { icon: "üîÑ", label: "Join reordering for efficiency." },
                {
                    icon: "üèóÔ∏è",
                    label: "Convert optimized logical plan to physical plan.",
                },
            ];
            const optStepDesc = [
                "Logical plan is analyzed for optimization opportunities.",
                "Predicate pushdown: Filters are applied as early as possible.",
                "Partition pruning: Only relevant partitions are scanned.",
                "Column pruning: Only necessary columns are read.",
                "Join reordering: Joins are rearranged for efficiency.",
                "Optimized logical plan is converted to a physical plan.",
            ];

            const execStepData = [
                {
                    icon: "üèóÔ∏è",
                    label: "Physical plan is split into execution stages.",
                },
                {
                    icon: "‚öôÔ∏è",
                    label: "Choose execution engine (MapReduce, Tez, Spark).",
                },
                { icon: "üó∫Ô∏è", label: "Build DAG of jobs/tasks." },
                {
                    icon: "üì§",
                    label: "Submit jobs to YARN for resource allocation.",
                },
            ];
            const execStepDesc = [
                "Physical plan is translated into one or more execution stages (MapReduce, Tez, or Spark jobs).",
                "Execution engine builds a DAG of tasks.",
                "Jobs are submitted to YARN for resource allocation and scheduling.",
                "Each stage may depend on the output of previous stages.",
            ];

            const jobStepData = [
                { icon: "üóÉÔ∏è", label: "YARN allocates containers for jobs." },
                { icon: "üìñ", label: "Map tasks read data splits from HDFS." },
                { icon: "üîÄ", label: "Shuffle and sort intermediate data." },
                {
                    icon: "üßÆ",
                    label: "Reduce tasks aggregate/process results.",
                },
                {
                    icon: "üíæ",
                    label: "Write intermediate/final results to HDFS.",
                },
            ];
            const jobStepDesc = [
                "YARN allocates containers for each job stage.",
                "Map tasks read data splits from HDFS.",
                "Shuffle and sort phase (if needed) organizes intermediate data.",
                "Reduce tasks aggregate and process results.",
                "Intermediate results may be written to HDFS between stages. Final output is written to HDFS or a temporary location.",
            ];

            const resStepData = [
                {
                    icon: "üì•",
                    label: "Driver fetches final output from HDFS/temp storage.",
                },
                {
                    icon: "üìù",
                    label: "Format results for client (table, CSV, etc.).",
                },
                {
                    icon: "üì§",
                    label: "Return results to user (CLI, file, API).",
                },
                { icon: "üîö", label: "Session may close or remain open." },
            ];
            const resStepDesc = [
                "Driver fetches the final output from HDFS or temporary storage.",
                "Results are formatted for the client (table, CSV, etc.).",
                "User receives the query result in the CLI, file, or API response.",
                "Session may be closed or kept alive for further queries.",
            ];



            // Unified View Functions for the merged section
            function showArchitectureView() {
                // Hide all views
                document.getElementById('architecture-view').style.display = 'block';
                document.getElementById('workflow-view').style.display = 'none';
                document.getElementById('integrated-view').style.display = 'none';

                // Update button states
                updateViewButtons('architecture');

                // Show unified info panel with architecture focus
                showUnifiedInfo('architecture',
                    'üèóÔ∏è Interactive Architecture View',
                    'Explore the enhanced interactive architecture from Section 2. Click on any component to see detailed information, real-time statistics, and data flow animations.'
                );
            }

            function showWorkflowView() {
                // Hide all views
                document.getElementById('architecture-view').style.display = 'none';
                document.getElementById('workflow-view').style.display = 'block';
                document.getElementById('integrated-view').style.display = 'none';

                // Update button states
                updateViewButtons('workflow');

                // Initialize workflow
                showStep(0);

                // Show unified info panel with workflow focus
                showUnifiedInfo('workflow',
                    'üîÑ Query Processing Workflow',
                    'Follow the step-by-step process of how Hive transforms your SQL queries into distributed processing jobs. Use the stepper above or navigation buttons to explore each phase.'
                );
            }

            function showIntegratedView() {
                // Hide all views
                document.getElementById('architecture-view').style.display = 'none';
                document.getElementById('workflow-view').style.display = 'none';
                document.getElementById('integrated-view').style.display = 'block';

                // Update button states
                updateViewButtons('integrated');

                // Show unified info panel with integrated focus
                showUnifiedInfo('integrated',
                    'üéØ Integrated Architecture + Workflow',
                    'See how architectural components and query processing workflow work together. This view shows the relationship between logical components and the processing steps they enable.'
                );
            }

            function updateViewButtons(activeView) {
                // Reset all buttons
                const buttons = ['architecture-view-btn', 'workflow-view-btn', 'integrated-view-btn'];
                buttons.forEach(btnId => {
                    const btn = document.getElementById(btnId);
                    if (btn) {
                        btn.style.opacity = '0.7';
                        btn.style.transform = 'scale(1)';
                    }
                });

                // Highlight active button
                const activeBtn = document.getElementById(activeView + '-view-btn');
                if (activeBtn) {
                    activeBtn.style.opacity = '1';
                    activeBtn.style.transform = 'scale(1.05)';
                }
            }

            function showUnifiedInfo(viewType, title, content) {
                const infoPanel = document.getElementById('unified-info-panel');
                const titleElement = document.getElementById('unified-info-title');
                const contentElement = document.getElementById('unified-info-content');

                if (infoPanel && titleElement && contentElement) {
                    titleElement.innerHTML = title;
                    contentElement.innerHTML = `<p>${content}</p>`;
                    infoPanel.style.display = 'block';

                    // Add view-specific styling
                    const colors = {
                        architecture: '#2196f3',
                        workflow: '#4caf50',
                        integrated: '#ff9800'
                    };

                    infoPanel.style.borderColor = colors[viewType] || '#2196f3';
                }
            }

            // Component details for unified architecture view
            const unifiedComponentDetails = {
                client: {
                    title: "üñ•Ô∏è Hive Client",
                    description: "Entry point for users to interact with Hive through various interfaces",
                    details: [
                        "‚Ä¢ <strong>Hive CLI:</strong> Command-line interface for direct HiveQL execution",
                        "‚Ä¢ <strong>Beeline:</strong> JDBC-based client with enhanced security features",
                        "‚Ä¢ <strong>JDBC/ODBC Drivers:</strong> Enable integration with BI tools and applications",
                        "‚Ä¢ <strong>Web UI:</strong> Browser-based interfaces like Hue for query management"
                    ],
                    role: "Submits queries and receives results from the Hive system"
                },
                driver: {
                    title: "üöó Hive Driver",
                    description: "Central coordinator that manages the entire query lifecycle and session state",
                    details: [
                        "‚Ä¢ <strong>Session Management:</strong> Handles client connections and maintains session state",
                        "‚Ä¢ <strong>Query Coordinator:</strong> Orchestrates the compilation and execution process",
                        "‚Ä¢ <strong>Result Handler:</strong> Manages query results and client communication",
                        "‚Ä¢ <strong>Error Management:</strong> Handles exceptions and provides detailed error reporting"
                    ],
                    role: "Coordinates the entire query processing workflow from submission to result delivery"
                },
                compiler: {
                    title: "üîß Compiler",
                    description: "Transforms HiveQL queries into executable plans through parsing and semantic analysis",
                    details: [
                        "‚Ä¢ <strong>Lexical Analysis:</strong> Tokenizes HiveQL statements",
                        "‚Ä¢ <strong>Syntax Parsing:</strong> Builds Abstract Syntax Tree (AST)",
                        "‚Ä¢ <strong>Semantic Analysis:</strong> Validates tables, columns, and data types",
                        "‚Ä¢ <strong>Plan Generation:</strong> Creates logical execution plan"
                    ],
                    role: "Converts SQL-like queries into logical plans that can be optimized and executed"
                },
                optimizer: {
                    title: "‚ö° Optimizer",
                    description: "Applies cost-based and rule-based optimizations to improve query performance",
                    details: [
                        "‚Ä¢ <strong>Predicate Pushdown:</strong> Moves filters closer to data sources",
                        "‚Ä¢ <strong>Join Reordering:</strong> Optimizes join sequence based on statistics",
                        "‚Ä¢ <strong>Column Pruning:</strong> Eliminates unnecessary columns from processing",
                        "‚Ä¢ <strong>Partition Pruning:</strong> Reduces data scanning using partition filters"
                    ],
                    role: "Optimizes logical plans to minimize resource usage and improve query performance"
                },
                execution: {
                    title: "üéØ Execution Engine",
                    description: "Converts optimized logical plans into executable jobs for distributed processing",
                    details: [
                        "‚Ä¢ <strong>Physical Plan Generation:</strong> Creates engine-specific execution plans",
                        "‚Ä¢ <strong>Task Scheduling:</strong> Schedules tasks across cluster nodes",
                        "‚Ä¢ <strong>Resource Management:</strong> Coordinates with YARN for resource allocation",
                        "‚Ä¢ <strong>Engine Support:</strong> MapReduce, Tez, Spark execution engines"
                    ],
                    role: "Translates optimized plans into distributed jobs that run on the Hadoop cluster"
                },
                metastore: {
                    title: "üóÑÔ∏è Metastore",
                    description: "Central repository for all metadata including schemas, tables, and partition information",
                    details: [
                        "‚Ä¢ <strong>Schema Storage:</strong> Table definitions, column types, constraints",
                        "‚Ä¢ <strong>Partition Metadata:</strong> Partition keys, locations, statistics",
                        "‚Ä¢ <strong>Storage Details:</strong> File formats, SerDe information, compression",
                        "‚Ä¢ <strong>Security Metadata:</strong> Access permissions and ownership information"
                    ],
                    role: "Provides metadata information needed for query compilation and optimization"
                }
            };

            function showUnifiedComponentDetails(componentId) {
                const component = unifiedComponentDetails[componentId];
                if (!component) return;

                // Highlight the selected component
                document.querySelectorAll('.unified-component').forEach(comp => {
                    comp.style.transform = 'scale(1)';
                    comp.style.boxShadow = '0 4px 16px rgba(0,0,0,0.1)';
                });

                // Highlight clicked component
                event.target.closest('.unified-component').style.transform = 'scale(1.05)';
                event.target.closest('.unified-component').style.boxShadow = '0 8px 25px rgba(0,0,0,0.2)';

                // Update unified info panel
                const titleElement = document.getElementById('unified-info-title');
                const contentElement = document.getElementById('unified-info-content');

                if (titleElement && contentElement) {
                    titleElement.innerHTML = component.title;

                    let detailsHtml = `<p style="margin-bottom: 15px; font-size: 1.1em; color: #444;"><strong>${component.description}</strong></p>`;
                    detailsHtml += '<div style="margin-bottom: 15px;">';
                    component.details.forEach(detail => {
                        detailsHtml += `<div style="margin-bottom: 8px; padding-left: 10px;">${detail}</div>`;
                    });
                    detailsHtml += '</div>';
                    detailsHtml += `<div style="background: rgba(33, 150, 243, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #2196f3;">`;
                    detailsHtml += `<strong>üéØ Role in Query Processing:</strong><br>${component.role}`;
                    detailsHtml += '</div>';

                    contentElement.innerHTML = detailsHtml;

                    // Show the panel
                    document.getElementById('unified-info-panel').style.display = 'block';
                }
            }

            // Initialize with first step
            document.addEventListener("DOMContentLoaded", function () {
                showStep(0);
                handleResponsiveLayout();

                // Initialize the unified view (start with architecture view)
                showArchitectureView();

                // Add keyboard navigation
                document.addEventListener("keydown", function(event) {
                    if (event.key === "ArrowLeft" || event.key === "ArrowUp") {
                        event.preventDefault();
                        navigateStep(-1);
                    } else if (event.key === "ArrowRight" || event.key === "ArrowDown") {
                        event.preventDefault();
                        navigateStep(1);
                    } else if (event.key >= "1" && event.key <= "6") {
                        event.preventDefault();
                        showStep(parseInt(event.key) - 1);
                    }
                });

                // Handle window resize
                window.addEventListener("resize", handleResponsiveLayout);
            });
        </script>




        <style>
            .hardware-component:hover {
                transform: translateY(-5px) scale(1.02);
                box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            }

            .hardware-component.active {
                transform: translateY(-8px) scale(1.05);
                box-shadow: 0 15px 35px rgba(0,0,0,0.2);
                border-width: 4px;
            }

            .flow-step.active {
                opacity: 1 !important;
                transform: scale(1.1);
                box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
            }

            .data-flow-indicator.active {
                opacity: 1;
                animation: pulse-flow 1s ease-in-out infinite;
            }

            @keyframes pulse-flow {
                0%, 100% { transform: translateY(-50%) scale(1); opacity: 0.8; }
                50% { transform: translateY(-50%) scale(1.2); opacity: 1; }
            }

            /* Unified Component Styles */
            .unified-component:hover {
                transform: translateY(-3px) scale(1.02) !important;
                box-shadow: 0 12px 30px rgba(0,0,0,0.15) !important;
            }

            .unified-component:active {
                transform: translateY(-1px) scale(1.01) !important;
            }

            @media (max-width: 768px) {
                #hardware-grid {
                    grid-template-columns: 1fr 1fr;
                    gap: 15px;
                }

                #flow-steps {
                    flex-direction: column;
                }

                #flow-steps > div:nth-child(even) {
                    transform: rotate(90deg);
                    margin: 10px 0;
                }
            }
        </style>

        <script>
            // Combined architecture and hardware details
            const componentDetails = {
                // Hardware details
                client: {
                    title: "üíª Client Machines",
                    description: "End-user interfaces and application servers that submit queries to Hive",
                    components: [
                        { name: "Developer Workstations", desc: "IDEs, SQL clients, data exploration tools" },
                        { name: "Application Servers", desc: "Web applications, microservices, ETL tools" },
                        { name: "BI Tools", desc: "Tableau, Power BI, Looker connecting via JDBC/ODBC" },
                        { name: "Command Line", desc: "Hive CLI, Beeline for direct query execution" }
                    ],
                    specs: "Typical: 8-32GB RAM, 4-16 CPU cores, SSD storage",
                    type: "hardware"
                },
                gateway: {
                    title: "üåê Gateway Nodes",
                    description: "Entry points that handle client connections and provide security/load balancing",
                    components: [
                        { name: "HiveServer2", desc: "Main service accepting JDBC/ODBC connections" },
                        { name: "Load Balancers", desc: "Distribute client requests across multiple HiveServer2 instances" },
                        { name: "Security Gateway", desc: "Authentication, authorization, SSL termination" },
                        { name: "Web UI", desc: "Hue, Ambari, or custom web interfaces" }
                    ],
                    specs: "Typical: 32-64GB RAM, 8-16 CPU cores, high network bandwidth",
                    type: "hardware"
                },
                master: {
                    title: "üß† Master Nodes",
                    description: "Control plane services that manage metadata, resources, and coordination",
                    components: [
                        { name: "NameNode (HDFS)", desc: "Manages file system namespace and metadata" },
                        { name: "ResourceManager (YARN)", desc: "Cluster resource allocation and job scheduling" },
                        { name: "Hive Metastore", desc: "Stores table schemas, partitions, and statistics" },
                        { name: "History Server", desc: "Job history and monitoring information" }
                    ],
                    specs: "Typical: 64-128GB RAM, 16-32 CPU cores, fast SSD, redundant setup",
                    type: "hardware"
                },
                worker: {
                    title: "‚öôÔ∏è Worker Nodes",
                    description: "Compute and storage nodes that execute actual data processing tasks",
                    components: [
                        { name: "DataNodes (HDFS)", desc: "Store actual data blocks with replication" },
                        { name: "NodeManagers (YARN)", desc: "Manage containers and local resources" },
                        { name: "Task Executors", desc: "Run Map/Reduce, Tez, or Spark tasks" },
                        { name: "Local Storage", desc: "Temporary data, spill files, caching" }
                    ],
                    specs: "Typical: 64-256GB RAM, 16-48 CPU cores, multiple HDDs/SSDs",
                    type: "hardware"
                },
                storage: {
                    title: "üíæ Distributed Storage",
                    description: "Persistent storage layer for data and metadata",
                    components: [
                        { name: "HDFS Cluster", desc: "Distributed file system with fault tolerance" },
                        { name: "Object Storage", desc: "Cloud storage (S3, Azure Blob, Google Cloud)" },
                        { name: "Metastore Database", desc: "MySQL, PostgreSQL for metadata storage" },
                        { name: "Backup Systems", desc: "Data replication and disaster recovery" }
                    ],
                    specs: "Petabyte scale, 3x replication, mixed HDD/SSD tiers",
                    type: "hardware"
                },
                // Architecture component details
                driver: {
                    title: "üöó Hive Driver",
                    description: "Central coordinator that manages the entire query lifecycle",
                    components: [
                        { name: "Session Management", desc: "Handles client connections and maintains session state" },
                        { name: "Query Coordinator", desc: "Orchestrates the compilation and execution process" },
                        { name: "Result Handler", desc: "Manages query results and client communication" },
                        { name: "Error Management", desc: "Handles exceptions and error reporting" }
                    ],
                    specs: "Runs on Gateway Nodes with HiveServer2",
                    type: "logical"
                },
                compiler: {
                    title: "üîß Hive Compiler",
                    description: "Transforms HiveQL queries into executable plans",
                    components: [
                        { name: "Lexical Analyzer", desc: "Tokenizes the input query string" },
                        { name: "Parser", desc: "Creates Abstract Syntax Tree (AST)" },
                        { name: "Semantic Analyzer", desc: "Validates schema and generates logical plan" },
                        { name: "Plan Generator", desc: "Creates initial execution plan" }
                    ],
                    specs: "CPU-intensive process running on Master Nodes",
                    type: "logical"
                },
                optimizer: {
                    title: "‚ö° Query Optimizer",
                    description: "Optimizes query execution plans for better performance",
                    components: [
                        { name: "Cost-Based Optimizer", desc: "Uses statistics for optimal plan selection" },
                        { name: "Rule-Based Optimizer", desc: "Applies predefined optimization rules" },
                        { name: "Predicate Pushdown", desc: "Moves filters closer to data source" },
                        { name: "Join Reordering", desc: "Optimizes join sequence and methods" }
                    ],
                    specs: "Memory-intensive process requiring table statistics",
                    type: "logical"
                },
                execution: {
                    title: "üöÄ Execution Engine",
                    description: "Converts optimized plans into executable jobs",
                    components: [
                        { name: "Physical Plan Generator", desc: "Creates engine-specific execution plans" },
                        { name: "Task Scheduler", desc: "Schedules tasks across cluster nodes" },
                        { name: "Resource Manager", desc: "Manages compute and memory resources" },
                        { name: "Progress Monitor", desc: "Tracks job execution and provides status" }
                    ],
                    specs: "Coordinates with YARN ResourceManager for job submission",
                    type: "logical"
                },
                yarn: {
                    title: "üîÑ YARN/Execution Engines",
                    description: "Distributed processing frameworks that execute Hive jobs",
                    components: [
                        { name: "MapReduce", desc: "Traditional batch processing framework" },
                        { name: "Apache Tez", desc: "DAG-based execution engine for better performance" },
                        { name: "Apache Spark", desc: "In-memory processing for faster analytics" },
                        { name: "LLAP", desc: "Live Long and Process for interactive queries" }
                    ],
                    specs: "Runs on Worker Nodes managed by YARN NodeManagers",
                    type: "logical"
                },
                hdfs: {
                    title: "üíΩ HDFS Storage",
                    description: "Distributed file system for storing large datasets",
                    components: [
                        { name: "NameNode", desc: "Manages file system metadata and namespace" },
                        { name: "DataNodes", desc: "Store actual data blocks across cluster" },
                        { name: "Block Management", desc: "Handles data replication and recovery" },
                        { name: "File Operations", desc: "Provides file system interface for applications" }
                    ],
                    specs: "Distributed across Worker Nodes with 3x replication",
                    type: "logical"
                },
                metastore: {
                    title: "üìä Hive Metastore",
                    description: "Central repository for Hive metadata and schema information",
                    components: [
                        { name: "Schema Storage", desc: "Stores table and column definitions" },
                        { name: "Partition Management", desc: "Manages table partitioning information" },
                        { name: "Statistics Storage", desc: "Stores table and column statistics for CBO" },
                        { name: "Security Metadata", desc: "Manages access control and permissions" }
                    ],
                    specs: "Typically MySQL/PostgreSQL database on Master Nodes",
                    type: "logical"
                }
            };

            let flowInterval;
            let currentFlowStep = 0;
            let currentView = 'logical';

            // View switching functions
            function showLogicalView() {
                currentView = 'logical';
                document.getElementById('logical-view').style.display = 'block';
                document.getElementById('physical-view').style.display = 'none';
                document.getElementById('integrated-view').style.display = 'none';

                // Update button states
                updateViewButtons('logical-view-btn');
                hideDetailsPanel();
            }

            function showPhysicalView() {
                currentView = 'physical';
                document.getElementById('logical-view').style.display = 'none';
                document.getElementById('physical-view').style.display = 'block';
                document.getElementById('integrated-view').style.display = 'none';

                // Update button states
                updateViewButtons('physical-view-btn');
                hideDetailsPanel();
            }

            function showIntegratedView() {
                currentView = 'integrated';
                document.getElementById('logical-view').style.display = 'none';
                document.getElementById('physical-view').style.display = 'none';
                document.getElementById('integrated-view').style.display = 'block';

                // Update button states
                updateViewButtons('integrated-view-btn');
                hideDetailsPanel();
            }

            function updateViewButtons(activeId) {
                const buttons = ['logical-view-btn', 'physical-view-btn', 'integrated-view-btn'];
                buttons.forEach(id => {
                    const btn = document.getElementById(id);
                    if (id === activeId) {
                        btn.style.background = btn.style.background.replace('0.8', '1');
                        btn.style.transform = 'scale(1.05)';
                    } else {
                        btn.style.transform = 'scale(1)';
                        btn.style.opacity = '0.8';
                    }
                });
            }

            function hideDetailsPanel() {
                document.getElementById('details-panel').style.display = 'none';
            }

            // Component detail functions
            function showHardwareDetails(componentType) {
                showComponentDetails(componentType, 'hardware');
            }

            function showArchDetails(componentType) {
                showComponentDetails(componentType, 'logical');
            }

            function showComponentDetails(componentType, detailType) {
                const details = componentDetails[componentType];
                if (!details) return;

                const panel = document.getElementById('details-panel');
                const content = document.getElementById('details-content');

                // Remove active class from all components
                document.querySelectorAll('.hardware-component, .arch-component').forEach(comp => {
                    comp.classList.remove('active');
                });

                // Add active class to clicked component
                const targetElement = detailType === 'hardware'
                    ? document.getElementById(componentType + '-hardware')
                    : document.getElementById('arch-' + componentType);

                if (targetElement) {
                    targetElement.classList.add('active');
                }

                content.innerHTML = `
                    <h3 style="color: #e65100; margin-top: 0;">${details.title}</h3>
                    <p style="font-size: 1.1em; color: #4e342e; margin-bottom: 20px;">${details.description}</p>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                        ${details.components.map(comp => `
                            <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 10px; border-left: 4px solid #ff9800;">
                                <strong style="color: #e65100;">${comp.name}</strong><br>
                                <span style="font-size: 0.9em; color: #666;">${comp.desc}</span>
                            </div>
                        `).join('')}
                    </div>

                    <div style="background: rgba(255, 193, 7, 0.1); padding: 15px; border-radius: 10px; margin-top: 20px;">
                        <strong style="color: #f57c00;">${details.type === 'hardware' ? 'Hardware Specifications:' : 'Implementation Details:'}</strong><br>
                        <span style="color: #4e342e;">${details.specs}</span>
                    </div>
                `;

                panel.style.display = 'block';
                panel.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            // Integrated view mapping functions
            function highlightMapping(componentType) {
                // Remove previous highlights
                document.querySelectorAll('.logical-component, .physical-component').forEach(comp => {
                    comp.style.transform = 'scale(1)';
                    comp.style.boxShadow = 'none';
                });

                // Highlight the mapping
                const logicalComp = document.querySelector(`[data-maps-to="${componentType}-hardware"]`);
                const physicalComp = document.getElementById(`mapped-${componentType}`);

                if (logicalComp) {
                    logicalComp.style.transform = 'scale(1.05)';
                    logicalComp.style.boxShadow = '0 8px 25px rgba(33, 150, 243, 0.3)';
                }

                if (physicalComp) {
                    physicalComp.style.transform = 'scale(1.05)';
                    physicalComp.style.boxShadow = '0 8px 25px rgba(255, 152, 0, 0.3)';
                }

                // Show details
                showHardwareDetails(componentType);
            }

            // Data flow animation functions
            function startDataFlow() {
                const startBtn = document.getElementById('start-flow-btn');
                const stopBtn = document.getElementById('stop-flow-btn');

                if (!startBtn || !stopBtn) return;

                startBtn.disabled = true;
                stopBtn.disabled = false;

                currentFlowStep = 0;

                // Reset all steps
                document.querySelectorAll('.flow-step').forEach(step => {
                    step.classList.remove('active');
                });

                // Start the flow animation
                flowInterval = setInterval(() => {
                    // Remove active from previous step
                    if (currentFlowStep > 0) {
                        const prevStep = document.getElementById(`flow-step-${currentFlowStep}`);
                        if (prevStep) prevStep.classList.remove('active');
                    }

                    currentFlowStep++;

                    if (currentFlowStep <= 5) {
                        // Activate current step
                        const currentStepEl = document.getElementById(`flow-step-${currentFlowStep}`);
                        if (currentStepEl) currentStepEl.classList.add('active');

                        // Activate data flow indicators
                        if (currentFlowStep <= 4) {
                            const indicators = document.querySelectorAll('.data-flow-indicator');
                            if (indicators[currentFlowStep - 1]) {
                                indicators[currentFlowStep - 1].classList.add('active');
                            }
                        }
                    } else {
                        // Reset and restart
                        currentFlowStep = 0;
                        document.querySelectorAll('.flow-step').forEach(step => {
                            step.classList.remove('active');
                        });
                        document.querySelectorAll('.data-flow-indicator').forEach(indicator => {
                            indicator.classList.remove('active');
                        });
                    }
                }, 1500);
            }

            function stopDataFlow() {
                const startBtn = document.getElementById('start-flow-btn');
                const stopBtn = document.getElementById('stop-flow-btn');

                if (!startBtn || !stopBtn) return;

                startBtn.disabled = false;
                stopBtn.disabled = true;

                if (flowInterval) {
                    clearInterval(flowInterval);
                    flowInterval = null;
                }

                // Keep current state but stop animation
                document.querySelectorAll('.data-flow-indicator').forEach(indicator => {
                    indicator.classList.remove('active');
                });
            }

            function resetHardwareView() {
                // Stop any running animation
                stopDataFlow();

                // Reset all visual states
                document.querySelectorAll('.hardware-component, .arch-component, .logical-component, .physical-component').forEach(comp => {
                    comp.classList.remove('active');
                    comp.style.transform = 'scale(1)';
                    comp.style.boxShadow = 'none';
                });

                document.querySelectorAll('.flow-step').forEach(step => {
                    step.classList.remove('active');
                });

                document.querySelectorAll('.data-flow-indicator').forEach(indicator => {
                    indicator.classList.remove('active');
                });

                // Hide details panel
                hideDetailsPanel();

                currentFlowStep = 0;
            }

            // Initialize the view
            document.addEventListener('DOMContentLoaded', function() {
                showLogicalView(); // Start with logical view
            });
        </script>

        <!-- Conclusion Section -->
        <div class="content-section">
            <h2>12. Conclusion</h2>
            <p>Apache Hive has revolutionized big data analytics by providing a familiar SQL interface to the Hadoop ecosystem. Key takeaways:</p>

            <div class="highlight-box">
                <h3>Key Advantages:</h3>
                <ul>
                    <li><strong>SQL Familiarity:</strong> Enables traditional database developers to work with big data</li>
                    <li><strong>Schema Flexibility:</strong> Schema-on-read approach for diverse data formats</li>
                    <li><strong>Scalability:</strong> Handles petabyte-scale data across distributed clusters</li>
                    <li><strong>Ecosystem Integration:</strong> Works seamlessly with Hadoop ecosystem tools</li>
                    <li><strong>Multiple Execution Engines:</strong> Support for MapReduce, Tez, and Spark</li>
                    <li><strong>Rich Data Types:</strong> Support for complex nested data structures</li>
                </ul>
            </div>

            <h3>12.1 When to Use Hive</h3>
            <ul>
                <li>Large-scale ETL operations and data warehousing</li>
                <li>Batch processing of structured and semi-structured data</li>
                <li>Data analysis requiring SQL-like interface</li>
                <li>Integration with existing Hadoop infrastructure</li>
                <li>Long-running analytical queries on historical data</li>
                <li>Data transformation and aggregation workflows</li>
            </ul>

            <h3>12.2 Limitations and Considerations</h3>
            <ul>
                <li><strong>High Latency:</strong> Not suitable for real-time or interactive queries</li>
                <li><strong>Limited ACID Support:</strong> Basic transactional capabilities</li>
                <li><strong>Schema Evolution:</strong> Can be challenging with some file formats</li>
                <li><strong>Small File Problem:</strong> Performance issues with many small files</li>
                <li><strong>Memory Requirements:</strong> Can be memory-intensive for complex queries</li>
            </ul>

            <h3>12.3 Future of Hive</h3>
            <p>Hive continues to evolve with:</p>
            <ul>
                <li><strong>LLAP (Live Long and Process):</strong> Interactive query processing</li>
                <li><strong>ACID Transactions:</strong> Improved transactional support</li>
                <li><strong>Materialized Views:</strong> Query performance optimization</li>
                <li><strong>Cloud Integration:</strong> Better support for cloud storage systems</li>
                <li><strong>Streaming Support:</strong> Real-time data processing capabilities</li>
            </ul>

            <div class="highlight-box">
                <strong>Final Thought:</strong> Apache Hive remains a cornerstone of the big data ecosystem, providing a bridge between traditional SQL-based analytics and distributed big data processing. Its ability to handle massive datasets with familiar SQL syntax makes it an essential tool for data warehousing and ETL operations in the Hadoop ecosystem.
            </div>
        </div>

        <!-- GitHub Appreciation Section -->
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 40px 20px; margin: 40px 0; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <div style="max-width: 600px; margin: 0 auto;">
                <h3 style="margin-bottom: 20px; font-size: 1.8em;">üåü Enjoyed This Interactive Guide?</h3>
                <p style="font-size: 1.2em; margin-bottom: 25px; opacity: 0.95;">
                    If this interactive Hive architecture guide helped you understand big data warehousing better,
                    please consider giving it a star on GitHub!
                </p>
                <div style="margin-bottom: 20px;">
                    <a href="https://github.com/AashishTangnami/bigdata-architecture.git"
                       target="_blank"
                       style="display: inline-block; background: rgba(255,255,255,0.2); color: white; text-decoration: none; padding: 15px 30px; border-radius: 25px; font-weight: bold; font-size: 1.1em; transition: all 0.3s ease; border: 2px solid rgba(255,255,255,0.3);"
                       onmouseover="this.style.background='rgba(255,255,255,0.3)'; this.style.transform='translateY(-2px)'"
                       onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.transform='translateY(0)'">
                        ‚≠ê Star on GitHub ‚≠ê
                    </a>
                </div>
                
            </div>
        </div>
    </body>
</html>
